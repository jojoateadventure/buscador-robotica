<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oficinas de Robótica</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- React & Lucide Icons via CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        @media print {
            /* Oculta absolutamente tudo por padrão */
            body * { visibility: hidden; }
            .no-print { display: none !important; }
            
            /* Torna visível apenas a área de planejamento e seus filhos */
            .custom-print-area, .custom-print-area * {
                visibility: visible;
            }

            /* Reposiciona a área de impressão para o topo da página */
            .custom-print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                display: block !important;
                padding: 0 !important;
                margin: 0 !important;
            }

            /* Ajustes visuais para a impressão */
            .print-border { 
                border: 1px solid #000 !important; 
                border-radius: 8px !important; 
                margin-bottom: 15px !important;
                padding: 15px !important;
                page-break-inside: avoid;
            }
            .bg-slate-900 { background: #000 !important; color: #fff !important; -webkit-print-color-adjust: exact; }
            .bg-blue-50\/50 { background: #f1f5f9 !important; -webkit-print-color-adjust: exact; }
            
            /* Remove sombras e fundos desnecessários */
            .shadow-2xl, .shadow-xl { box-shadow: none !important; }
            .bg-slate-900\/60 { background: transparent !important; }
        }
    </style>
</head>
<body class="bg-slate-50/30">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        const Icon = ({ name, size = 20, className = "" }) => {
            useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
            }, [name]);
            return <i data-lucide={name} className={className} style={{ width: size, height: size }}></i>;
        };

        const generateFullDatabase = () => {
            const db = [];
            const years = ["1º Ano", "2º Ano", "3º Ano", "4º Ano", "5º Ano", "6º Ano", "7º Ano", "8º Ano", "9º Ano"];
            const bnccCodes = ["EF15C008", "EF01MA15", "EF02CI01", "EF03MA04", "EF04CI03", "EF05CI11", "EF06MA10", "EF07CO03", "EF08CO04", "EF09CO01"];
            const temasBase = [
                "Conhecendo o Kit", "Elementos Funcionais", "Engrenagens", "Polias", "Alavancas", 
                "Tração Animal", "Sensores de Toque", "Sensores de Cor", "Motores e Rotação", "Programação em Bloco",
                "Loop Infinito", "Condicionais", "Variáveis", "Lógica de Movimento", "Desafio do Labirinto",
                "Robô Seguidor de Linha", "Braço Hidráulico", "Elevador de Carga", "Energia Solar", "Torneio Final"
            ];

            years.forEach((ano, indexAno) => {
                for (let i = 1; i <= 20; i++) {
                    const id = (indexAno + 1) * 100 + i;
                    const tema = temasBase[(i - 1) % temasBase.length];
                    db.push({
                        id: id,
                        oficina: i,
                        ano: ano,
                        tema: tema,
                        bncc: bnccCodes[indexAno] || "EF09CO01",
                        objetivo: `Desenvolver competências de robótica e pensamento computacional através da montagem e lógica aplicada ao tema ${tema}.`,
                        metodologia: `1. Contextualização: Debate sobre a aplicação real do tema.\n2. Montagem: Uso do Kit LEGO® para prototipagem.\n3. Programação: Criação do código para execução da tarefa.\n4. Avaliação: Teste de performance e ajustes.`,
                        materiais: "Kit Robótica Educacional, Tablet/Laptop, Peças de Reposição."
                    });
                }
            });
            return db;
        };

        const rawData = generateFullDatabase();

        const ModalPlanejamento = ({ item, onClose }) => {
            const [formData, setFormData] = useState({
                professor: '',
                turma: '',
                data: new Date().toLocaleDateString('pt-BR'),
                observacoes: ''
            });

            const copyFullPlan = () => {
                const text = `PLANO DE AULA - OFICINAS DE ROBÓTICA\nTEMA: ${item.tema}\nANO: ${item.ano} | OFICINA: #${item.oficina}\nBNCC: ${item.bncc}\nPROFESSOR: ${formData.professor}\nTURMA: ${formData.turma}\nDATA: ${formData.data}\nOBJETIVOS: ${item.objetivo}\nMETODOLOGIA: ${item.metodologia}\nMATERIAIS: ${item.materiais}\nOBSERVAÇÕES: ${formData.observacoes}`;
                navigator.clipboard.writeText(text).then(() => alert("Copiado com sucesso!"));
            };

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-md no-print">
                    <div className="bg-white w-full max-w-4xl max-h-[90vh] rounded-[2rem] shadow-2xl overflow-hidden flex flex-col">
                        <div className="px-8 py-5 border-b flex justify-between items-center bg-slate-50 no-print">
                            <h2 className="font-bold text-slate-800 flex items-center gap-2">
                                <Icon name="file-text" className="text-blue-600" /> Novo Planejamento
                            </h2>
                            <button onClick={onClose} className="p-2 hover:bg-slate-200 rounded-full transition-colors">
                                <Icon name="x" className="text-slate-400" />
                            </button>
                        </div>

                        <div className="flex-grow overflow-y-auto p-8 custom-print-area">
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
                                <div className="md:col-span-2 space-y-6">
                                    <div className="bg-slate-900 text-white p-8 rounded-3xl relative overflow-hidden print-border">
                                        <span className="text-[10px] font-black uppercase text-blue-400">{item.ano} • Oficina #{item.oficina}</span>
                                        <h1 className="text-3xl font-black mt-1 mb-4 uppercase leading-none">{item.tema}</h1>
                                        <div className="flex items-center gap-2 text-[10px] font-bold bg-white/10 w-fit px-3 py-1.5 rounded-full uppercase">
                                            <Icon name="target" size={14} /> {item.bncc}
                                        </div>
                                    </div>
                                    
                                    {/* Campos de Input - Ocultos na impressão por padrão mas seus valores devem aparecer se usarmos spans */}
                                    <div className="grid grid-cols-2 gap-4 no-print">
                                        <input 
                                            className="w-full bg-slate-50 border border-slate-200 p-3 rounded-xl outline-none" 
                                            placeholder="Nome do docente"
                                            value={formData.professor}
                                            onChange={e => setFormData({...formData, professor: e.target.value})}
                                        />
                                        <input 
                                            className="w-full bg-slate-50 border border-slate-200 p-3 rounded-xl outline-none" 
                                            placeholder="Turma / Período"
                                            value={formData.turma}
                                            onChange={e => setFormData({...formData, turma: e.target.value})}
                                        />
                                    </div>

                                    {/* Exibição apenas para impressão dos dados preenchidos */}
                                    <div className="hidden print:block space-y-2 mt-4">
                                        <p className="text-sm"><strong>Professor:</strong> {formData.professor || '____________________'}</p>
                                        <p className="text-sm"><strong>Turma:</strong> {formData.turma || '____________________'}</p>
                                        <p className="text-sm"><strong>Data:</strong> {formData.data}</p>
                                    </div>
                                </div>
                                <div className="bg-blue-50/50 p-6 rounded-3xl border border-blue-100 space-y-4 print-border">
                                    <h4 className="font-bold text-blue-900 text-xs uppercase flex items-center gap-2">
                                        <Icon name="clock" className="text-blue-500" /> Base Pedagógica
                                    </h4>
                                    <p className="text-[11px] text-blue-900/70 leading-relaxed italic">{item.objetivo}</p>
                                </div>
                            </div>
                            <div className="space-y-6">
                                <div className="bg-white border-2 border-slate-100 p-6 rounded-2xl text-slate-600 text-sm whitespace-pre-wrap print-border">
                                    <span className="font-black text-[9px] uppercase block mb-2 text-slate-400">Roteiro</span>
                                    {item.metodologia}
                                </div>
                                <div className="bg-white border-2 border-slate-100 p-6 rounded-2xl text-slate-600 text-sm whitespace-pre-wrap print-border">
                                    <span className="font-black text-[9px] uppercase block mb-2 text-slate-400">Materiais</span>
                                    {item.materiais}
                                </div>
                                {formData.observacoes && (
                                    <div className="bg-white border-2 border-slate-100 p-6 rounded-2xl text-slate-600 text-sm whitespace-pre-wrap print-border">
                                        <span className="font-black text-[9px] uppercase block mb-2 text-slate-400">Anotações</span>
                                        {formData.observacoes}
                                    </div>
                                )}
                                <textarea 
                                    className="w-full bg-slate-50 border border-slate-200 p-5 rounded-2xl min-h-[100px] no-print"
                                    placeholder="Observações adicionais..."
                                    value={formData.observacoes}
                                    onChange={e => setFormData({...formData, observacoes: e.target.value})}
                                />
                            </div>
                        </div>

                        <div className="p-6 bg-slate-50 border-t flex gap-4 no-print">
                            <button onClick={copyFullPlan} className="flex-1 bg-white border p-4 rounded-2xl font-black text-[10px] uppercase flex items-center justify-center gap-2">
                                <Icon name="copy" /> Copiar Texto
                            </button>
                            <button onClick={() => window.print()} className="flex-1 bg-blue-600 text-white p-4 rounded-2xl font-black text-[10px] uppercase flex items-center justify-center gap-2">
                                <Icon name="download" /> Imprimir / PDF
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [search, setSearch] = useState('');
            const [filterYear, setFilterYear] = useState('Todos');
            const [selected, setSelected] = useState(null);
            const years = ['Todos', '1º Ano', '2º Ano', '3º Ano', '4º Ano', '5º Ano', '6º Ano', '7º Ano', '8º Ano', '9º Ano'];

            const results = useMemo(() => {
                if (!search && filterYear === 'Todos') return [];
                return rawData.filter(item => {
                    const matchesText = item.tema.toLowerCase().includes(search.toLowerCase()) || item.bncc.toLowerCase().includes(search.toLowerCase());
                    const matchesYear = filterYear === 'Todos' || item.ano === filterYear;
                    return matchesText && matchesYear;
                });
            }, [search, filterYear]);

            return (
                <div className="min-h-screen">
                    <nav className="border-b bg-white sticky top-0 z-10 no-print">
                        <div className="max-w-5xl mx-auto px-6 h-20 flex items-center gap-3">
                            <div className="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center text-white">
                                <Icon name="graduation-cap" size={24} />
                            </div>
                            <h1 className="font-black text-slate-900 text-lg uppercase">Oficinas de Robótica</h1>
                        </div>
                    </nav>

                    <main className="max-w-5xl mx-auto px-6 py-12">
                        <section className={`text-center no-print ${results.length > 0 ? 'mb-12' : 'mt-20'}`}>
                            {!results.length && (
                                <div className="mb-10">
                                    <h2 className="text-5xl font-black text-slate-900 mb-4 tracking-tighter">O que vamos <span className="text-blue-600">ensinar hoje?</span></h2>
                                    <p className="text-slate-400 font-medium">Busque por tema ou selecione o ano escolar abaixo.</p>
                                </div>
                            )}
                            <div className="max-w-2xl mx-auto space-y-6">
                                <input 
                                    className="w-full px-8 py-6 bg-white border border-slate-100 rounded-[2rem] shadow-xl outline-none text-xl font-bold"
                                    placeholder="Pesquisar oficina..."
                                    value={search}
                                    onChange={e => setSearch(e.target.value)}
                                />
                                <div className="flex gap-2 overflow-x-auto pb-4 no-scrollbar">
                                    {years.map(y => (
                                        <button key={y} onClick={() => setFilterYear(y)} className={`px-5 py-2 rounded-full text-[10px] font-black uppercase whitespace-nowrap border-2 ${filterYear === y ? 'bg-slate-900 text-white border-slate-900' : 'bg-white text-slate-400 border-slate-100'}`}>
                                            {y}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </section>

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {results.map(item => (
                                <div key={item.id} onClick={() => setSelected(item)} className="bg-white border rounded-[2rem] p-8 hover:border-blue-500 cursor-pointer transition-all flex flex-col justify-between group no-print">
                                    <div>
                                        <div className="flex justify-between mb-4">
                                            <span className="text-[9px] font-black bg-blue-50 text-blue-600 px-3 py-1 rounded-full">{item.ano}</span>
                                            <span className="text-[9px] font-bold text-slate-200 uppercase">#{item.oficina}</span>
                                        </div>
                                        <h3 className="text-xl font-black text-slate-800 uppercase group-hover:text-blue-600">{item.tema}</h3>
                                        <p className="text-slate-400 text-xs mt-2 italic line-clamp-2">{item.objetivo}</p>
                                    </div>
                                    <div className="mt-6 pt-4 border-t flex justify-between items-center">
                                        <span className="text-[9px] font-black text-slate-300 uppercase">{item.bncc}</span>
                                        <Icon name="file-text" size={14} className="text-slate-200 group-hover:text-blue-600" />
                                    </div>
                                </div>
                            ))}
                        </div>
                    </main>

                    {selected && <ModalPlanejamento item={selected} onClose={() => setSelected(null)} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
